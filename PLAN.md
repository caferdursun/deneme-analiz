# Development Plan

## Project: Deneme Analiz - University Exam Tracker

**Goal**: Build a web-based system to track and analyze Eren's university entrance exam preparation progress.

**Timeline**: 5 Phases (Iterative development)

---

## Phase 1: Foundation & Core PDF Analysis
**Duration**: Days 1-3
**Status**: Not Started

### Objectives
- Set up development environment
- Create database schema
- Implement PDF analysis with Claude API
- Build basic data storage

### Tasks

#### 1.1 Environment Setup
- [x] Create project documentation (CLAUDE.md, ARCHITECTURE.md, PLAN.md)
- [ ] Initialize Git repository
- [ ] Create directory structure
- [ ] Set up Python virtual environment
- [ ] Install core dependencies (FastAPI, SQLAlchemy, Alembic)
- [ ] Configure environment variables (.env file)
- [ ] Set up database (PostgreSQL or SQLite)

#### 1.2 Database Setup
- [ ] Design database schema (see ARCHITECTURE.md)
- [ ] Create SQLAlchemy models
  - [ ] Student model
  - [ ] Exam model
  - [ ] ExamResult model
  - [ ] SubjectResult model
  - [ ] LearningOutcome model
  - [ ] Question model
- [ ] Initialize Alembic
- [ ] Create initial migration
- [ ] Apply migration and verify tables

#### 1.3 Claude API Integration
- [ ] Create Claude API client utility
- [ ] Design PDF analysis prompt
- [ ] Test prompt with existing exam.pdf
- [ ] Implement structured JSON extraction
- [ ] Add error handling and retries
- [ ] Create validation logic for extracted data

#### 1.4 Backend API - Basic Endpoints
- [ ] Set up FastAPI application structure
- [ ] Create database connection and session management
- [ ] Implement POST /api/exams/upload endpoint
  - [ ] File upload handling
  - [ ] Save PDF to file system
  - [ ] Call Claude API for analysis
  - [ ] Parse and validate response
  - [ ] Store in database
  - [ ] Return exam ID
- [ ] Implement GET /api/exams endpoint (list all exams)
- [ ] Implement GET /api/exams/{exam_id} endpoint (get exam details)
- [ ] Add CORS middleware
- [ ] Test endpoints with Postman/curl

#### 1.5 Data Validation
- [ ] Create Pydantic schemas for request/response
- [ ] Validate extracted data format
- [ ] Check for data completeness
- [ ] Handle edge cases (canceled questions, blank answers)
- [ ] Add logging for debugging

### Deliverables
- âœ… Working backend API with PDF upload and analysis
- âœ… Database with exam data stored
- âœ… First exam (exam.pdf) successfully processed
- âœ… API documentation (auto-generated by FastAPI)

### Success Criteria
- Upload exam.pdf via API
- Get structured exam data back
- Verify data in database matches PDF content
- All 88 questions correctly mapped

---

## Phase 2: Basic Web Interface
**Duration**: Days 4-5
**Status**: Not Started

### Objectives
- Create simple React frontend
- Implement PDF upload UI
- Display exam results

### Tasks

#### 2.1 Frontend Setup
- [ ] Initialize React app with TypeScript
- [ ] Set up Tailwind CSS
- [ ] Install dependencies (React Router, React Query, Axios)
- [ ] Configure API client
- [ ] Set up routing structure

#### 2.2 Upload Page
- [ ] Create upload page component
- [ ] Implement drag-and-drop file upload
- [ ] Add file validation (PDF only, size limits)
- [ ] Show upload progress
- [ ] Handle success/error states
- [ ] Redirect to exam detail on success

#### 2.3 Exam List Page
- [ ] Create exam list component
- [ ] Fetch exams from API
- [ ] Display exam cards with summary
  - Exam name and date
  - Overall net score
  - Subject breakdown
  - Rankings
- [ ] Add sorting (by date, score)
- [ ] Click to view details

#### 2.4 Exam Detail Page
- [ ] Create exam detail layout
- [ ] Display overall results
  - Net score, rankings
  - Class and school comparison
- [ ] Display subject breakdown table
- [ ] Show correct/wrong/blank for each subject
- [ ] Display learning outcomes list
- [ ] Show question-level data
- [ ] Highlight wrong and blank questions

#### 2.5 Basic Styling
- [ ] Create consistent layout
- [ ] Add responsive design (mobile-friendly)
- [ ] Use Tailwind for styling
- [ ] Add loading states
- [ ] Add error boundaries

### Deliverables
- âœ… Working web interface
- âœ… Can upload PDFs through UI
- âœ… Can view list of all exams
- âœ… Can view detailed exam results

### Success Criteria
- User can upload exam.pdf via web interface
- Results display correctly with all details
- Mobile-responsive design
- Smooth user experience

---

## Phase 3: Analytics & Visualizations
**Duration**: Days 6-8
**Status**: Not Started

### Objectives
- Implement analytics calculations
- Create interactive charts
- Build dashboard

### Tasks

#### 3.1 Backend Analytics API
- [ ] Implement GET /api/analytics/overview
  - Overall progress summary
  - Total exams count
  - Average net score trend
  - Best/worst subjects
- [ ] Implement GET /api/analytics/subjects
  - Per-subject progress over time
  - Subject comparisons
- [ ] Implement GET /api/analytics/trends
  - Net score evolution
  - Ranking trends
  - Improvement velocity
- [ ] Implement GET /api/analytics/comparisons
  - Student vs. class average trends
  - Student vs. school average trends
- [ ] Implement GET /api/analytics/learning-outcomes
  - Topic-level success rates
  - Weak areas identification
  - Improvement tracking by topic
- [ ] Add caching for expensive queries
- [ ] Optimize database queries with proper indexes

#### 3.2 Chart Components
- [ ] Install charting library (Recharts or Chart.js)
- [ ] Create LineChart component (score trends)
- [ ] Create BarChart component (subject comparisons)
- [ ] Create PieChart component (subject distribution)
- [ ] Create RadarChart component (multi-dimension comparison)
- [ ] Create AreaChart component (cumulative progress)
- [ ] Make charts responsive and interactive

#### 3.3 Dashboard Page
- [ ] Create dashboard layout
- [ ] Add summary cards
  - Total exams
  - Latest net score
  - Average score
  - Ranking trend
- [ ] Add overall progress chart (net score over time)
- [ ] Add subject comparison chart
- [ ] Add student vs. averages comparison
- [ ] Add recent exams list
- [ ] Add quick stats section

#### 3.4 Subject Analysis Page
- [ ] Create subject-specific view
- [ ] Show progress chart per subject
- [ ] Display topic breakdown
- [ ] Show weak areas in subject
- [ ] Compare with class/school averages
- [ ] List related learning outcomes

#### 3.5 Learning Outcomes Page
- [ ] Create hierarchical topic display
- [ ] Show success rate by topic
- [ ] Color-code by performance level
- [ ] Filter by subject
- [ ] Show historical performance on each outcome
- [ ] Identify consistently weak outcomes

### Deliverables
- âœ… Rich analytics API
- âœ… Interactive dashboard with charts
- âœ… Detailed subject analysis
- âœ… Learning outcomes tracking

### Success Criteria
- Upload 2-3 exams to see trends
- Charts update automatically
- Can identify weak subjects and topics
- Performance is smooth (< 2s load time)

---

## Phase 4: Recommendations Engine
**Duration**: Days 9-10
**Status**: Not Started

### Objectives
- Implement recommendation algorithm
- Generate AI-powered study suggestions
- Create recommendations UI

### Tasks

#### 4.1 Recommendation Algorithm
- [ ] Design recommendation scoring system
- [ ] Implement pattern detection
  - Consistently weak subjects
  - High blank rate topics
  - Declining performance trends
  - Low learning outcome success
- [ ] Calculate impact scores
- [ ] Prioritize recommendations
- [ ] Generate action items

#### 4.2 AI-Powered Recommendations
- [ ] Create prompt for Claude to generate study suggestions
- [ ] Send student performance data to Claude
- [ ] Extract structured recommendations
- [ ] Validate and format recommendations
- [ ] Store in recommendations table

#### 4.3 Backend Recommendations API
- [ ] Implement GET /api/recommendations
  - Fetch active recommendations
  - Order by priority
  - Group by subject
- [ ] Implement POST /api/recommendations/refresh
  - Trigger recommendation regeneration
  - Use latest exam data
- [ ] Add background job for automatic regeneration
  - Trigger after each new exam
- [ ] Implement recommendation lifecycle
  - Mark as completed
  - Archive old recommendations

#### 4.4 Recommendations UI
- [ ] Create recommendations page
- [ ] Display recommendation cards
  - Priority indicator
  - Subject/topic
  - Issue description
  - Action items checklist
  - Rationale
- [ ] Group by priority
- [ ] Filter by subject
- [ ] Add mark as completed functionality
- [ ] Show impact score visualization

#### 4.5 Integration
- [ ] Show top 3 recommendations on dashboard
- [ ] Add recommendation banner on weak subjects
- [ ] Link recommendations to related learning outcomes
- [ ] Add print/export recommendations feature

### Deliverables
- âœ… Smart recommendation engine
- âœ… AI-generated study suggestions
- âœ… Actionable recommendations UI
- âœ… Automatic updates after new exams

### Success Criteria
- Recommendations are relevant and actionable
- Clear prioritization
- Covers all weak areas
- Updates automatically with new data

---

## Phase 5: Polish & Advanced Features
**Duration**: Days 11-12
**Status**: Not Started

### Objectives
- Improve UX/UI
- Add advanced features
- Optimize performance
- Prepare for production

### Tasks

#### 5.1 UX Improvements
- [ ] Add loading skeletons
- [ ] Improve error messages
- [ ] Add success notifications (toast)
- [ ] Add confirmation dialogs
- [ ] Improve mobile responsiveness
- [ ] Add keyboard shortcuts
- [ ] Add tooltips and help text
- [ ] Implement dark mode (optional)

#### 5.2 Advanced Features
- [ ] Compare two exams side-by-side
- [ ] Export data to Excel/CSV
- [ ] Generate PDF report
- [ ] Question review mode
  - Review wrong questions
  - Mark questions for later review
- [ ] Study progress tracking
  - Mark topics as studied
  - Track study time
- [ ] Goal setting
  - Set target scores
  - Track progress towards goals

#### 5.3 Performance Optimization
- [ ] Implement pagination for exam lists
- [ ] Add database query optimization
- [ ] Implement caching strategy
- [ ] Optimize PDF processing time
- [ ] Add lazy loading for images/charts
- [ ] Minimize bundle size

#### 5.4 Testing
- [ ] Write backend unit tests
  - Test models
  - Test services
  - Test API endpoints
- [ ] Write frontend component tests
- [ ] Add integration tests
- [ ] Test error scenarios
- [ ] Test with multiple PDFs

#### 5.5 Documentation
- [ ] Write API documentation
- [ ] Create user guide
- [ ] Add code comments
- [ ] Document deployment process
- [ ] Create troubleshooting guide

#### 5.6 Deployment Preparation
- [ ] Set up production database
- [ ] Configure production environment variables
- [ ] Set up Nginx reverse proxy
- [ ] Create systemd service for backend
- [ ] Build optimized frontend
- [ ] Set up SSL certificate
- [ ] Configure firewall
- [ ] Set up backup strategy
- [ ] Add monitoring and logging

### Deliverables
- âœ… Polished, production-ready application
- âœ… Comprehensive test coverage
- âœ… Complete documentation
- âœ… Deployed and accessible

### Success Criteria
- Application is fast and responsive
- No critical bugs
- Easy to use
- Ready for daily use by Eren
- Can handle multiple exam uploads

---

## Phase 6: Validation Report Enhancement
**Duration**: 1-2 Days
**Status**: Not Started
**Priority**: Medium

### Objectives
- Allow user to review and choose between Claude API and local parser results
- Persist validation report for user review
- Enable manual data source selection before database commit

### Problem Statement
Currently, the validation report appears briefly and then disappears. The system automatically merges or chooses data from Claude API and local parser, but the user has no control over which data source to trust and save to the database.

### Tasks

#### 6.1 Backend Changes
- [ ] Modify upload endpoint to return validation report without auto-saving
- [ ] Create new endpoint: POST /api/exams/{exam_id}/confirm
  - Accept data_source parameter ("claude" or "local")
  - Save chosen data to database
  - Mark exam as confirmed
- [ ] Add exam status field (pending_confirmation, confirmed)
- [ ] Store both Claude and local parser results temporarily
- [ ] Add cleanup job for unconfirmed exams after 24 hours

#### 6.2 Frontend - Validation Review Page
- [ ] Create ValidationReviewPage component
- [ ] Display side-by-side comparison:
  - Left column: Claude API results
  - Right column: Local parser results
- [ ] Highlight differences between two sources
  - Use color coding (green = match, red = mismatch)
  - Show field-by-field comparison
- [ ] Add comparison statistics
  - Overall accuracy match percentage
  - Number of discrepancies
  - Critical vs. non-critical differences
- [ ] Implement data source selection
  - Radio buttons: "Use Claude API" / "Use Local Parser"
  - Or field-by-field selection for fine-grained control
- [ ] Add confirmation flow
  - "Confirm and Save" button
  - Show summary before final save
  - Redirect to exam detail page after save

#### 6.3 UI/UX Improvements
- [ ] Add visual diff highlighting
  - Red for Claude-only values
  - Blue for local parser-only values
  - Green for matching values
- [ ] Add tooltips explaining differences
- [ ] Show validation report summary
  - Total errors/warnings/info
  - Quick stats comparison
- [ ] Add "Review Later" option
  - Save as pending_confirmation status
  - Add to review queue
- [ ] Implement keyboard shortcuts
  - 'C' for Claude, 'L' for Local, 'Enter' to confirm

#### 6.4 Data Management
- [ ] Create pending exams list
  - Show all exams awaiting confirmation
  - Filter by date, status
  - Quick action buttons
- [ ] Add notification system
  - Alert user of pending reviews
  - Show count badge on navigation
- [ ] Implement auto-cleanup
  - Delete unconfirmed exams after 24h
  - Send reminder before deletion

### Deliverables
- âœ… Persistent validation reports
- âœ… Manual data source selection UI
- âœ… Side-by-side comparison view
- âœ… Pending exams management

### Success Criteria
- User can review validation report at their own pace
- Clear visual indication of data differences
- Can choose data source before database commit
- No data loss during review process
- Intuitive and fast workflow

### Example Workflow
1. User uploads PDF
2. System processes with both Claude API and local parser
3. User redirected to validation review page
4. User sees side-by-side comparison with highlighted differences
5. User selects preferred data source (or field-by-field)
6. User confirms and saves
7. Data committed to database
8. User redirected to exam detail page

---

## Phase 7: Learning Outcomes Data Management
**Duration**: 1-2 Days
**Status**: Not Started
**Priority**: Medium

### Objectives
- Export learning outcomes data to Excel for manual review and editing
- Import cleaned/merged learning outcomes data back to database
- Provide tools to identify and merge similar learning outcomes
- Enable data cleanup as exam count grows

### Problem Statement
As exams are added to the system, learning outcomes from different sources may have:
- Slightly different names for the same outcome (e.g., "Deyimler" vs "Deyim Bilgisi")
- Different categorizations but same content
- Inconsistent subject naming (e.g., "Matematik.09" vs "Matematik.10")
- Duplicate or near-duplicate entries

Users need a way to export, clean, merge similar outcomes, and re-import the data.

### Tasks

#### 7.1 Backend - Excel Export
- [ ] Install openpyxl or xlsxwriter library
- [ ] Create export service for learning outcomes
- [ ] Design Excel format with multiple sheets:
  - **Sheet 1: Learning Outcomes** - All learning outcome records with columns:
    - ID, Exam ID, Exam Name, Subject Name, Category, Subcategory
    - Outcome Description, Total Questions, Acquired, Lost
    - Success Rate, Student %, Class %, School %
    - Created At
  - **Sheet 2: Exams** - Related exam information for reference
  - **Sheet 3: Metadata** - Export timestamp, record count, filters applied
- [ ] Implement GET /api/learning-outcomes/export endpoint
  - Accept optional filters (subject, date range, exam_id)
  - Generate Excel file with proper formatting
  - Return file download response
- [ ] Add cell formatting:
  - Headers in bold
  - Freeze first row
  - Auto-width columns
  - Color-code success rates (red < 50%, yellow 50-80%, green > 80%)
- [ ] Include formulas for calculated fields

#### 7.2 Backend - Excel Import
- [ ] Create import service for learning outcomes
- [ ] Implement POST /api/learning-outcomes/import endpoint
  - Accept Excel file upload
  - Validate file structure and data
  - Parse Excel sheets
  - Map columns to database fields
- [ ] Implement validation rules:
  - Check required fields
  - Validate data types
  - Verify foreign key relationships (exam_id exists)
  - Check for duplicate IDs
- [ ] Create import preview/dry-run mode:
  - Show what will be changed
  - Display warnings and errors
  - Allow user to review before committing
- [ ] Implement merge strategies:
  - **Replace**: Delete existing, insert new data
  - **Update**: Update existing records by ID
  - **Append**: Add new records, keep existing
  - **Merge**: Intelligently combine similar outcomes
- [ ] Add transaction support (rollback on error)
- [ ] Generate import report:
  - Records processed
  - Records added/updated/deleted
  - Errors and warnings
  - Summary statistics

#### 7.3 Backend - Similarity Detection
- [ ] Create similarity detection algorithm
- [ ] Implement fuzzy matching for outcome descriptions
  - Use Levenshtein distance or similar
  - Calculate similarity scores (0-100%)
- [ ] Group similar outcomes:
  - By subject name (normalized)
  - By category + subcategory
  - By outcome description similarity
- [ ] Create GET /api/learning-outcomes/similar endpoint
  - Return groups of similar outcomes
  - Include similarity scores
  - Suggest merge candidates
- [ ] Implement merge preview:
  - Show which records will be combined
  - Display aggregated statistics
  - Allow user to select primary record

#### 7.4 Backend - Merge Operations
- [ ] Create POST /api/learning-outcomes/merge endpoint
- [ ] Implement merge logic:
  - Accept array of outcome IDs to merge
  - Accept target outcome (primary record)
  - Aggregate statistics (sum questions, acquired, appearances)
  - Recalculate success rates
  - Update or delete merged records
- [ ] Handle exam relationships:
  - Maintain links to source exams
  - Don't lose data provenance
- [ ] Add merge history tracking:
  - Create audit log table
  - Record what was merged and when
  - Allow undo if needed

#### 7.5 Frontend - Export UI
- [ ] Add "Export" button on Learning Outcomes page
- [ ] Create export dialog:
  - Select filters (subject, date range)
  - Choose format options
  - Preview record count
- [ ] Implement file download handling
- [ ] Show success notification with file info
- [ ] Add loading state during export

#### 7.6 Frontend - Import UI
- [ ] Add "Import" button on Learning Outcomes page
- [ ] Create import dialog/page:
  - File upload area
  - Drag-and-drop support
  - File validation (Excel only)
- [ ] Implement import preview:
  - Display parsed data in table
  - Show validation errors/warnings
  - Highlight changes (additions, updates, deletions)
- [ ] Add merge strategy selector
  - Radio buttons for replace/update/append/merge
  - Explain each option
- [ ] Implement confirmation step:
  - Summary of changes
  - "Confirm Import" button
  - Show import progress
- [ ] Display import results:
  - Success/error counts
  - Detailed log
  - Link to updated data

#### 7.7 Frontend - Similarity & Merge UI
- [ ] Create "Find Similar" page/dialog
- [ ] Display similarity groups:
  - Expandable cards for each group
  - Show all outcomes in group
  - Display similarity scores
  - Highlight differences
- [ ] Implement merge interface:
  - Checkbox selection of outcomes to merge
  - Select primary outcome (keeps this data)
  - Preview merged result
  - Show aggregated statistics
- [ ] Add batch merge functionality:
  - Auto-suggest high-confidence merges (>90% similarity)
  - Allow user to review and approve
  - One-click bulk merge
- [ ] Show merge confirmation:
  - "Are you sure?" dialog
  - Display what will change
  - Undo option

#### 7.8 Excel Format Specification
- [ ] Document Excel structure in code comments
- [ ] Create example/template Excel file
- [ ] Include README sheet in exported files:
  - Instructions for editing
  - Column descriptions
  - Import guidelines
- [ ] Add data validation in Excel:
  - Dropdown lists for subject names
  - Number ranges for percentages
  - Date formats

### Deliverables
- âœ… Excel export functionality with complete data
- âœ… Excel import with validation and preview
- âœ… Similarity detection algorithm
- âœ… Merge interface for combining similar outcomes
- âœ… Complete audit trail of changes

### Success Criteria
- User can export all learning outcomes to Excel
- Excel file is well-formatted and includes all relationships
- User can edit Excel file and re-import successfully
- Validation catches errors before committing changes
- Similar outcomes are accurately detected (>80% accuracy)
- User can merge similar outcomes without losing data
- All changes are tracked and reversible

### Example Workflow
1. User clicks "Export" on Learning Outcomes page
2. System generates Excel file with all outcomes data
3. User downloads and opens in Excel
4. User manually edits/merges similar entries
5. User saves Excel file
6. User clicks "Import" and uploads edited file
7. System validates and shows preview of changes
8. User reviews and confirms import
9. Data is updated in database
10. User sees updated learning outcomes list

### Alternative Workflow (Auto-Merge)
1. User clicks "Find Similar Outcomes"
2. System analyzes all outcomes and groups similar ones
3. User reviews suggested merges
4. User approves/rejects each merge suggestion
5. System combines approved outcomes
6. User sees cleaned-up learning outcomes list

---

## Future Roadmap (Post-MVP)

### Short-term (1-2 months)
- [ ] Multi-user support (for friends/classmates)
- [ ] Question bank integration
- [ ] Spaced repetition study scheduler
- [ ] Mobile app (React Native)
- [ ] Email notifications for recommendations

### Medium-term (3-6 months)
- [ ] AI tutor chat interface
- [ ] Peer comparison (anonymous)
- [ ] Study group features
- [ ] Video lessons integration
- [ ] Predictive analytics (ML models)

### Long-term (6+ months)
- [ ] Integration with official exam systems
- [ ] Marketplace for study materials
- [ ] Teacher/mentor portal
- [ ] Live classes integration
- [ ] Gamification and achievements

---

## Risk Management

### Technical Risks
- **Risk**: Claude API rate limits or downtime
  - **Mitigation**: Implement retry logic, fallback to manual entry
- **Risk**: PDF format variations
  - **Mitigation**: Make parser flexible, add format detection
- **Risk**: Database performance with many exams
  - **Mitigation**: Proper indexing, query optimization, pagination

### Schedule Risks
- **Risk**: Complexity underestimation
  - **Mitigation**: Prioritize MVP features, defer nice-to-haves
- **Risk**: Claude API integration issues
  - **Mitigation**: Test early, have backup plan

---

## Success Metrics

### Phase 1
- [ ] Can process exam.pdf without errors
- [ ] Database contains accurate data

### Phase 2
- [ ] User can upload and view exam results
- [ ] Mobile-friendly interface

### Phase 3
- [ ] Can visualize progress with 3+ exams
- [ ] Analytics load in < 2 seconds

### Phase 4
- [ ] Generates 5-10 relevant recommendations
- [ ] Updates automatically

### Phase 5
- [ ] Application deployed and accessible
- [ ] Zero critical bugs
- [ ] Eren uses it regularly

---

## Notes

- This plan is iterative; each phase builds on the previous
- Start simple, add complexity gradually
- Test with real data (exam.pdf) at each phase
- Get feedback from Eren after each phase
- Be flexible to adjust based on learnings
- Document decisions and changes in PROGRESS.md

---

## Getting Started

To begin implementation:
1. âœ… Read CLAUDE.md for project context
2. âœ… Review ARCHITECTURE.md for design details
3. âœ… Follow Phase 1 tasks in order
4. Update PROGRESS.md as you complete tasks
5. Commit code regularly with descriptive messages

Let's build something great! ðŸš€
